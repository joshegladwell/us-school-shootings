
<!DOCTYPE html>
<html>
    
    <head>
        <title>Na&iuml;ve Bayes</title>

        <!-- point to css stylesheet -->
        <link rel="stylesheet" href="../styles.css">
    </head>


    <body>
        <div class="header">
            <div class="header-center">
                <a class="logo" href="../index.html">jg</a>
            </div>
            <div class="header-sub">
                Joshua Gladwell
            </div>
            <div class="header-tabs">
                <a href="./about_me.html">About Me</a>
                <a href="https://github.com/anly501/anly-501-project-joshegladwell" target="_blank">Code</a>
                <a href="https://github.com/anly501/anly-501-project-joshegladwell/tree/main/data" target="_blank">Data</a>
                <a href="./introduction.html">Introduction</a>
                <a href="./data_gathering.html">Data Gathering</a>
                <a href="./data_cleaning.html">Data Cleaning</a>
                <a href="./exploring_data.html">Exploring Data</a>
                <a href="./naive_bayes.html">Na&iuml;ve Bayes</a>
                <a href="./decision_trees.html">Decision Trees</a>
                <a href="./svm.html">SVM</a>
                <a href="./clustering.html">Clustering</a>
                <a href="./arm_networking.html">ARM and Networking</a>
                <a href="./conclusions.html">Conclusions</a>
            </div>
        </div>
        <div class="text">
            <h1>Na&iuml;ve Bayes</h1>

            <h2>Classifying Tweets</h2>
            <p>In this section of the project I will be performing Na&iuml;ve Bayes classification using Twitter data relating to school shootings. The original intent of this section was to classify tweets based on their political sentiments, but we explain further in the section why that approach is neither responsible nor viable. Instead, we classify tweets based on their intent&mdash;whether they are expressing opinions or sharing news.</p>
            <p>I have a corpus of about 2.5 million tweets mentioning school shootings, which I obtained using the academic access Twitter API. The labels I will use to train my Na&iuml;ve Bayes model will come from hashtags in the tweets. I will identify some of the most common hashtags in my corpus to identify classes of interest, and I will then train a Na&iuml;ve Bayes algorithm to group tweets into these classes. The top ten most cited hashtags in the corpus are as follows:</p>

            <table class="center-table">
                <tr>
                    <th>Hashtag</th>
                    <th>Count</th>
                </tr>
                <tr>
                    <td>#shooting</td>
                    <td>9,754</td>
                </tr>
                <tr>
                    <td>#news</td>
                    <td>8,014</td>
                </tr>
                <tr>
                    <td>#school</td>
                    <td>7,519</td>
                </tr>
                <tr>
                    <td>#gunviolence</td>
                    <td>2,761</td>
                </tr>
                <tr>
                    <td>#guncontrol</td>
                    <td>2,567</td>
                </tr>
                <tr>
                    <td>#schoolshooting</td>
                    <td>2,437</td>
                </tr>
                <tr>
                    <td>#guncontrolnow</td>
                    <td>2,407</td>
                </tr>
                <tr>
                    <td>#nra</td>
                    <td>2,277</td>
                </tr>
                <tr>
                    <td>#shooter</td>
                    <td>1,715</td>
                </tr>
                <tr>
                    <td>#parkland</td>
                    <td>1,711</td>
                </tr>
            </table>

            <p>While the original intent of this analysis was going to be prediction of the political standing of each tweet based on the hashtags, the value counts have shown that the data are too biased for this kind of approach. The vast majority of hashtags included in tweets are in favor of gun control, which makes sense because the tweets were queried specifically in connection to individual school shooting incidents. The majority of expressed sentiment after a tragic school shooting incident would understandably be to tighten gun laws. I believe that it is for this reason that the value counts of the hashtags are highly imbalanced, with far greater gun control sentiment over gun rights sentiment.</p>
            <p>The other issue with this approach would be the ambiguity associated with each label. If we were to treat hashtags as the labels classifying whether a tweet supports stricter or looser gun laws, it is entirely possible that a given hashtag could appear in either type of tweet. For example, a hashtag #nra may appear in a tweet that criticizes National Rifle Association (NRA) agendas or it may appear in a tweet that supports them. These biases in the data have forced a new approach.</p>
            <p>Instead of predicting a tweet's political standing, we will instead classify tweets as "News" tweets or "Opinion" tweets. The labels for this analysis will be applied based on the type of hashtags used in the tweet. Hashtag classifications are defined below.</p>

            <table class="center-table">
                <tr>
                    <th>News</th>
                    <th>Opinion</th>
                </tr>
                <tr>
                    <td>#news</td>
                    <td>#guncontrolnow</td>
                </tr>
                <tr>
                    <td>#breakingnews</td>
                    <td>#gunsense</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#gunreformnow</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#neveragain</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#endgunviolence</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#stopgunviolence</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#enoughisenough</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#nrabloodmoney</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#rejectthenra</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#enough</td>
                </tr>
                <tr>
                    <td></td>
                    <td>#momsdemand</td>
                </tr>
            </table>

            <p>With these hashtag classification criteria, we now assign these class labels to the tweets that contain the hashtags of interest. The value counts for these tweets are as follows:</p>

            <table class="center-table">
                <tr>
                    <th>Label</th>
                    <th>Count</th>
                </tr>
                <tr>
                    <td>Opinion</td>
                    <td>21,154</td>
                </tr>
                <tr>
                    <td>News</td>
                    <td>18,251</td>
                </tr>
                <tr>
                    <td>Both</td>
                    <td>82</td>
                </tr>
            </table>

            <p>The "Both" label represents tweets tha have hashtags from both classes in them. Impressively, there are only 82 of them. We examine the content of a couple of them below:</p>
            <br>
            <div>
                <blockquote class="twitter-tweet tw-align-center"><p lang="en" dir="ltr">“We’re expected to be human shields”: Teachers are unprotected — and scared <a href="https://t.co/11ehIs3AuH">https://t.co/11ehIs3AuH</a> <a href="https://twitter.com/hashtag/news?src=hash&amp;ref_src=twsrc%5Etfw">#news</a> <a href="https://twitter.com/hashtag/feedly?src=hash&amp;ref_src=twsrc%5Etfw">#feedly</a> <a href="https://twitter.com/hashtag/education?src=hash&amp;ref_src=twsrc%5Etfw">#education</a> <a href="https://twitter.com/hashtag/teachertwitter?src=hash&amp;ref_src=twsrc%5Etfw">#teachertwitter</a> <a href="https://twitter.com/hashtag/GunControlNow?src=hash&amp;ref_src=twsrc%5Etfw">#GunControlNow</a></p>&mdash; Fat Puppy Productions (@FatPuppyProduc1) <a href="https://twitter.com/FatPuppyProduc1/status/1536366312372555776?ref_src=twsrc%5Etfw">June 13, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

                <blockquote class="twitter-tweet tw-align-center"><p lang="en" dir="ltr">Enough. This has to stop. <a href="https://twitter.com/hashtag/UvaldeMassacre?src=hash&amp;ref_src=twsrc%5Etfw">#UvaldeMassacre</a> <a href="https://twitter.com/hashtag/UvaldeStrong?src=hash&amp;ref_src=twsrc%5Etfw">#UvaldeStrong</a><a href="https://twitter.com/hashtag/truecrime?src=hash&amp;ref_src=twsrc%5Etfw">#truecrime</a><a href="https://twitter.com/hashtag/truecrimecommunity?src=hash&amp;ref_src=twsrc%5Etfw">#truecrimecommunity</a><a href="https://twitter.com/hashtag/BREAKING?src=hash&amp;ref_src=twsrc%5Etfw">#BREAKING</a><a href="https://twitter.com/hashtag/BreakingNews?src=hash&amp;ref_src=twsrc%5Etfw">#BreakingNews</a><a href="https://twitter.com/hashtag/Enough?src=hash&amp;ref_src=twsrc%5Etfw">#Enough</a><a href="https://t.co/lQ3wbaiCh0">https://t.co/lQ3wbaiCh0</a></p>&mdash; thiscountrygirlslife (@countrygrllife) <a href="https://twitter.com/countrygrllife/status/1529607430761549829?ref_src=twsrc%5Etfw">May 25, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </div>
            <br>
            <p>Clearly the "Both" class has some tweets that fall under "Opinion" tweets and some that fall under "News" tweets. The first tweet shown above would likely be considered a "News" tweet even though it contains hashtags that we define as being opinion-based. Likewise, the second tweet would probably be considered an "Opinion" tweet even though it contains a "News" hashtag. Luckily the number of tweets in this "Both" class is so small that it won't be necessary to include them in our training dataset. Our "Opinion" and "News" classes are roughly balanced (have about the same number of tweets belonging to each class), so we will proceed with training the Na&iuml;ve Bayes classifier on these data.</p>
            <p>With the classifier trained, we examine its performance using confusion matrices and numerical metrics. We can get the best impression of the classifier's performance by comparing it to a "baseline" model, or a model that is trained on completely random data. In the confusion matrices below, each square represents a classification group that a number of tweets belongs to. Working clockwise from the top left, the squares represent: tweets that were correctly classified as "News" tweets, "News" tweets that were incorrectly classified as "Opinion" tweets, tweets that were correctly classified as "Opinion" tweets, and "Opinion" tweets that were incorreclty classified as "News" tweets.</p>
            <img src="../images/naive_bayes/confusion_matrix_baseline.png" width="1200">
            <img src="../images/naive_bayes/confusion_matrix_trained.png" width="1200">
            <p>We can also use metrics to compare the performance between the two models. The definitions of these metrics are defined as:</p>
            <ul>
                <li><b>Accuracy</b>: The ratio of correct classifications to all classifications.</li>
                <li><b>Precision</b>: The ratio of true positives to the total number of true positives and false negatives. In this case, we define the positive class as a "News" tweet. Thus, in this scenario precision represents the classifier's propensity for correctly classifying "News" tweets.</li>
                <li><b>Recall</b>: The ratio of true positives to the total number of positives classified. In this case, we define the positive class as a "News" tweet. Thus, in this scenario recall represents the classifier's propensity for minimizing misclassification of "Opinion" tweets.</li>
                <li><b>F1</b>: The harmonic mean between precision and recall. In this scenario, it serves as a combination between the classifier's ability to correctly classify "News" tweets while minimizing misclassification of "Opinion" tweets.</li>
            </ul>
            <p>The results of the metrics are:</p>

            <table class="center-table">
                <tr>
                    <th>Metric</th>
                    <th>Trained Model</th>
                    <th>Baseline Model</th>
                </tr>
                <tr>
                    <td>Accuracy</td>
                    <td>0.878</td>
                    <td>0.486</td>
                </tr>
                <tr>
                    <td>Precision</td>
                    <td>0.861</td>
                    <td>0.430</td>
                </tr>
                <tr>
                    <td>Recall</td>
                    <td>0.881</td>
                    <td>0.315</td>
                </tr>
                <tr>
                    <td>F1</td>
                    <td>0.878</td>
                    <td>0.499</td>
                </tr>
            </table>

            <p>In conclusion, the model is quite good at classifying tweets as either "News" tweets or "Opinion" tweets. As in many machine learning algorithms, the model is only as good as its data. The use of hashtags as proxies for labels in this corpus of tweets about school shootings was certainly less than perfect, and therefore results in a poorer model.</p>
            <p>It is worth noting that this model was trained and tested exclusively on tweets with hashtags belonging to the classification dictionaries defined above. In total, this set of tweets totals to 39,405 tweets out of the total 2,485,482 tweets we retrieved using the Academic Research Twitter API. This offers an interesting opportunity to apply the model to the remaining 2.4 million tweets about school shootings, gaining insight into the variance between "Opinion" tweet frequency and "News" tweet frequency over time. This will be a point of future analysis, and will be updated here once performed.</p>

            <h2>Predicting News Coverage</h2>
            <p>The School Shooting Database offers a "News Coverage" feature in its dataset that indicates the level of media attention a given school shooting demanded. We are interested in whether factors such as a school's level (Elementary, Middle, High), racial demographic (percent of Black, Hispanic, Asian, and White students enrolled), and the number of fatalities resulting from the incident can accurately determine the level of news coverage (local, regional, national, or international) that the incident receives.</p>
            <p>We emphasize the intent of this analysis as uncovering insights into past incidents, and in no way do we intend to draw any conclusions on school shooting incidents that may occur in the future.</p>
            <p>In order to retrieve racial demographic data on United States schools we use the Urban Institute Education Data API to retrieve the desired data released by the Common Core of Data (CCD). Because the SSDB does not include National Center for Education Statistics IDs in its dataset, we create an artificial "pseudo-ID" composed from the year in which the data was gathered / the incident occurred, the two letter abbreviation of the state, the name of the city (excluding spaces), the first five characters of the school name, and a flag indicating whether the school is a high school or not (1 if yes, 0 if no). Despite the thorough construction of this pseudo-ID to link the SSDB data with the CCD data, only 781 schools were successfully linked between the two datasets out of 2,068 incidents in the SSDB. This major loss of data may adversely affect the performance of the Na&iuml;ve Bayes model, and may be an area to return to for future work.</p>
            <p>Another source of significant bias in this analysis may be the magnitude of missing data for the levels of media attention for each incident. Out of the 781 incidents with linked school data, 596 of them are missing information on the level of media coverage. After accounting for this and other missing data, the dataset is reduced to 133 school shooting incidents. The classes of media coverage for the incidents in the set are distributed as follows:</p>
            <table class="center-table">
                <tr>
                    <th>Local</th>
                    <th>Regional</th>
                    <th>National</th>
                    <th>International</th>
                </tr>
                <tr>
                    <td>89</td>
                    <td>13</td>
                    <td>24</td>
                    <td>7</td>
                </tr>
            </table>
            <p>The results of the Na&iuml;ve Bayes classification can be seen below.</p>
            <img src="../images/naive_bayes/confusion_matrix_baseline2.png" width="1200">
            <img src="../images/naive_bayes/confusion_matrix_trained2.png" width="1200">
            <p>Although the trained model performs much better than the baseline at predicting whether an incident's coverage will be local or not, for the most part the model isn't great at determining the level of news media. However, we can see from the accuracy below that the model is at least better than a random predictor, so it has some value.</p>
            <table class="center-table">
                <tr>
                    <th> </th>
                    <th>Trained Model</th>
                    <th>Baseline Model</th>
                </tr>
                <tr>
                    <td>Accuracy</td>
                    <td>0.529</td>
                    <td>0.373</td>
                </tr>
            </table>
            <p>This model can definitely use some work, but once it proves stronger performance it may offer value into filling some of the vast missing data for each school shooting incident's level of media attention. Having predictions for this data on all incidents could offer very interesting insights into the aspects of school shootings that the public deems most tragic about school shootings (or at the very least, insight into what the media perceives the public to deem most tragic about school shootings).</p>
        </div>
    </body>
</html>
